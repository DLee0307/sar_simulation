import numpy as np
import matplotlib.pyplot as plt
import matplotlib.animation as animation

# 데이터 정의
# data = {
#     "Time Step": list(range(1, 42)),
#     "Groundtruth": [
#         0.5, 0.49, 0.48, 0.47, 0.46, 0.45, 0.44, 0.43, 0.42, 0.41,
#         0.4, 0.39, 0.38, 0.37, 0.36, 0.35, 0.34, 0.33, 0.32, 0.31,
#         0.3, 0.29, 0.28, 0.27, 0.26, 0.25, 0.24, 0.23, 0.22, 0.21,
#         0.2, 0.19, 0.18, 0.17, 0.16, 0.15, 0.14, 0.13, 0.12, 0.11, 0.1
#     ],

#     "chessboard" : [
#         0.421910763, 0.404112279, 0.404112279, 0.402990907, 0.401814163, 
#         0.3903175, 0.385819465, 0.378374517, 0.378374517, 0.360630631, 
#         0.360630631, 0.382893263, 0.375161816, 0.359539191, 0.351398517, 
#         0.345829238, 0.335829238, 0.324108899, 0.311752766, 0.297230452, 
#         0.288499564, 0.284294099, 0.274294099, 0.264837235, 0.253020376, 
#         0.251994312, 0.231994312, 0.224749342, 0.215023249, 0.215023249, 
#         0.205705956, 0.205705956, 0.190529421, 0.177083105, 0.177083105, 
#         0.17892009, 0.166052639, 0.153579205, 0.153579205, 0.162311345, 0.163059995
#     ],

#     "stucco" : [
#         0.450958073, 0.447452933, 0.433941185, 0.429555088, 0.427339703, 
#         0.413137197, 0.405432552, 0.413764924, 0.37802583, 0.393114984, 
#         0.380963176, 0.363477349, 0.364024669, 0.348659664, 0.346984357, 
#         0.33515808, 0.334103018, 0.318677515, 0.316258967, 0.30408901, 
#         0.287908226, 0.289972901, 0.279672146, 0.27014333, 0.259369016, 
#         0.253189325, 0.253189325, 0.245210469, 0.228074402, 0.219427943, 
#         0.210193396, 0.201078713, 0.19749862, 0.191480637, 0.179596692, 
#         0.174728587, 0.166263625, 0.154385135, 0.137262851, 0.125389799, 0.122637942
#     ],

#     "treetrunk" : [
#         0.391122162, 0.385288537, 0.385288537, 0.363332897, 0.370705575, 
#         0.352465451, 0.357570022, 0.346714258, 0.335669279, 0.332182765, 
#         0.316877425, 0.308373779, 0.318357319, 0.313874841, 0.313874841, 
#         0.303509861, 0.291777879, 0.29514122, 0.282178789, 0.27566117, 
#         0.275243908, 0.26525405, 0.268996537, 0.26505667, 0.252584934, 
#         0.246891648, 0.246263295, 0.237208247, 0.228666395, 0.228368372, 
#         0.227372989, 0.227911621, 0.208967239, 0.218112499, 0.201144829, 
#         0.190350205, 0.186512917, 0.187003762, 0.173350126, 0.171237767, 0.171497524
#     ],

#     "brick" : [
#         0.405819446, 0.417288065, 0.404112548, 0.393396765, 0.381403953, 
#          0.363769442, 0.363730371, 0.352640837, 0.348184466, 0.335675538, 
#          0.321547776, 0.339356363, 0.320368081, 0.316735595, 0.323848486, 
#          0.306072623, 0.321233213, 0.287717044, 0.303753793, 0.292955399, 
#          0.28706345, 0.281752139, 0.280088872, 0.274246335, 0.271044374, 
#          0.266597629, 0.248426005, 0.241531208, 0.255371332, 0.211657032, 
#          0.212741598, 0.211852506, 0.206837118, 0.212852404, 0.198792621, 
#          0.202902377, 0.198696852, 0.222115681, 0.222115681, 0.234221295, 0.250477254
#     ]
# }


# 데이터 로드 #4.0 60deg
data = {
    "Time Step": list(range(1, 42)),
    "Groundtruth": [
        0.5, 0.49, 0.48, 0.47, 0.46, 0.45, 0.44, 0.43, 0.42, 0.41,
        0.4, 0.39, 0.38, 0.37, 0.36, 0.35, 0.34, 0.33, 0.32, 0.31,
        0.3, 0.29, 0.28, 0.27, 0.26, 0.25, 0.24, 0.23, 0.22, 0.21,
        0.2, 0.19, 0.18, 0.17, 0.16, 0.15, 0.14, 0.13, 0.12, 0.11, 0.1
    ],
    "chessboard" : [
        0.445232064, 0.430774331, 0.434874952, 0.437205702, 0.415642381, 
        0.417308599, 0.417308599, 0.410758942, 0.41802296, 0.39238587, 
        0.398225973, 0.379276961, 0.380927056, 0.370777955, 0.361784369, 
        0.349141955, 0.347418576, 0.345021119, 0.331896096, 0.324138582, 
        0.309602618, 0.325814575, 0.290612966, 0.287076503, 0.290593714, 
        0.259099554, 0.244540782, 0.238166075, 0.236730546, 0.22113825, 
        0.191039613, 0.190270753, 0.2028265, 0.184928328, 0.197312906, 
        0.193142667, 0.172101423, 0.17507872, 0.150040686, 0.163960502, 0.169662356
    ],

    "stucco" : [
        0.4815135, 0.465304613, 0.469016522, 0.460601568, 0.457742631, 
        0.434835523, 0.442392647, 0.429869056, 0.426199764, 0.402360588, 
        0.406867385, 0.394053936, 0.391343057, 0.383312851, 0.375180155, 
        0.368165135, 0.362548321, 0.355363756, 0.358164996, 0.345111191, 
        0.331208557, 0.331458598, 0.313305348, 0.292990804, 0.292990804, 
        0.286459923, 0.284857154, 0.272388518, 0.256332934, 0.248040378, 
        0.243405998, 0.233992085, 0.222379118, 0.215751365, 0.2238511, 
        0.201006263, 0.196358606, 0.189604968, 0.172419563, 0.163519114, 0.136048093
    ],

    "treetrunk" : [
        0.423422426, 0.421151191, 0.412107319, 0.415953338, 0.394209057, 
        0.399961978, 0.391667873, 0.382872552, 0.384763837, 0.380457342, 
        0.377667069, 0.356950015, 0.371232361, 0.358737856, 0.358063549, 
        0.356889516, 0.363712817, 0.350031346, 0.347876519, 0.346113741, 
        0.348928988, 0.347369134, 0.344315708, 0.332520604, 0.318033695, 
        0.318386912, 0.304232925, 0.296489954, 0.283558458, 0.279690027, 
        0.273670614, 0.266957164, 0.265618682, 0.265618682, 0.281654924, 
        0.283579826, 0.285514772, 0.2792252, 0.276824117, 0.314225733, 0.368737519
    ],

    "brick" : [
        0.456375152, 0.453598678, 0.466044873, 0.460216671, 0.429320395, 
        0.429320395, 0.444689095, 0.380194396, 0.438540906, 0.381233335, 
        0.394027621, 0.405319661, 0.402193606, 0.389052659, 0.390994221, 
        0.396694273, 0.394406974, 0.392122298, 0.389268786, 0.350256532, 
        0.358746648, 0.369541407, 0.28553471, 0.315113604, 0.302649498, 
        0.315329283, 0.321329266, 0.325476974, 0.325476974, 0.340998381, 
        0.375385225, 0.433669657, 0.305963308, 0.389508724, 0.302354604, 
        0.272527903, 0.259424269, 0.267722487, 0.27957347, 0.290692002, 0.300558478
    ]

}


# X, Y 데이터 분리
time_steps = np.array(data["Time Step"])
groundtruth = np.array(data["Groundtruth"])
chessboard = np.array(data["chessboard"])
stucco = np.array(data["stucco"])
treetrunk = np.array(data["treetrunk"])
brick = np.array(data["brick"])

# 애니메이션 설정
fig, ax = plt.subplots()
ax.set_xlim(min(time_steps), max(time_steps))
ax.set_ylim(min(min(groundtruth), min(brick)), max(max(groundtruth), max(brick)))
ax.set_xlabel("Time Step", fontsize=48)
ax.set_ylabel("Time-to-Contact", fontsize=48)
ax.tick_params(axis='both', labelsize=24)
ax.set_title("")

# 그래프 초기화
line1, = ax.plot([], [], 'k-', linewidth = 10, label="Groundtruth")  # 빨간색 선
#line2, = ax.plot([], [], 'r-', linewidth = 10, label="stucco")   # 파란색 선
#line2, = ax.plot([], [], 'g-', linewidth = 10, label="treetrunk")   # 파란색 선
line2, = ax.plot([], [], 'b-', linewidth = 10, label="brick")   # 파란색 선
#ax.legend()

# 프레임 업데이트 함수
def update(frame):
    line1.set_data(time_steps[:frame], groundtruth[:frame])
    line2.set_data(time_steps[:frame], brick[:frame])
    return line1, line2

# 애니메이션 생성 (4초 동안 실행)
ani = animation.FuncAnimation(fig, update, frames=len(time_steps), interval=4000/len(time_steps), blit=True)

# 객체를 유지하기 위해 변수를 유지
_ani = ani  

# 애니메이션을 화면에 출력
plt.show()

# # 비디오 파일로 저장
# video_path = "/mnt/data/Groundtruth_vs_Chessboard.mp4"
# ani.save(video_path, writer='ffmpeg', fps=len(time_steps)/4)

# # 비디오 파일 경로 반환
# video_path
